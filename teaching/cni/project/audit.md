# 实验目的

通过完成实验，理解数据链路层、网络层、传输层和应用层的基本原理。掌握用 Wireshark 观察网络流量并辅助网络侦听相关的编程；掌握用 Libpcap 或 WinPcap 库侦听并处理以太网帧和 IP 报文的方法；熟悉以太网帧、IP 报文、TCP 段和 FTP 命令的格式概念，掌握 TCP 协议的基本机制；熟悉帧头部或 IP 报文头部各字段的含义。熟悉 TCP 段和应用层数据协议的概念，熟悉 TCP 段头部各字段，熟悉 SMTP、FTP、HTTP 等协议的指令和数据的含义。

# 时间要求

- 预计完成时间：4 周（开发与实现）
- 成果整理时间：1 周
- 最终提交时间：第 9 周周日之前

# 需求说明

该课程项目包括网络审计功能和告警界面两部分。要求在交换型局域网的镜像端口上运行本网络软件（或在虚拟机中模拟），对局域网内用户访问外网的行为进行记录与审计。记录内容包括但不限于：源 IP、目的 IP、用户名、时间戳、以及与协议相关的详细信息。

具体审计项（至少应包含以下协议的监控与记录）：

1. HTTP 协议监控与审计
   - 审计项至少应包括：源 IP、目的 IP、URL、访问时间等信息。

2. TELNET 协议监控与审计
   - 审计项至少应包括：源 IP、目的 IP、操作用户名、操作命令、访问时间等信息。

3. FTP 协议监控与审计
   - 审计项至少应包括：源 IP、目的 IP、操作用户名、操作命令、文件/目录名、访问时间等信息。

4. DNS 协议监控与审计
   - 审计项至少应包括：源 IP、DNS 服务器地址、请求的域名、解析返回的 IP（若可见）、访问时间等信息。

5. SMTP / POP3 协议监控与审计
   - 审计项至少应包括：源 IP、目的 IP、发件人、收件人、邮件标题、附件名与大小、邮件收发时间等信息。

> 说明：以上协议均假定为明文传输，环境为纯英文（不需处理中文编码问题）。

# 技术建议

1. 开发语言自选；侦听抓包部分推荐使用 C/C++（libpcap/WinPcap），展示与告警界面可采用 LNMP（Linux + Nginx + MySQL + PHP/Python）或其他 Web 技术栈。
2. 了解并能调用命令行工具（如 tcpdump/ffmpeg 等）以辅助测试与调试。
3. 需要具备基本的数据库设计能力（用于存储审计日志、告警与用户信息）。
4. 测试环境建议：在交换机镜像端口或在虚拟化平台中构建受控流量环境以便验证功能与性能。

# 评分标准

该项目以软件功能与质量为主要评分依据，满分 100 分，建议评分分配如下（示例）：

- 基本功能实现（核心审计、抓包与存储）：60 分
- 界面能实时告警（告警延迟 ≤ 10 秒）：10 分
- 每实现一种协议的完整侦听与记录：10 分（按协议分别评分，累计不超过 100 分）

> 说明：总体评分上限为 100 分；以上为建议分配，评阅时可结合实现质量与创新加以调整。
