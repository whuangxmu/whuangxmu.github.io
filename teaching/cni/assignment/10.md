# 一、单项选择题

1. （　　） is (are) responsible for fragments reassembly.
   - A. The routers
   - B. The ultimate destination host
   - C. The source host
   - D. The routers and destination host

2. When transmitting frames without setting DF (Don't Fragment) tag, how does a router treat a frame that is larger than the outbound interfaces maximum transmission unit?
   - A. drops the packet
   - B. sends a host unreachable message to the sender
   - C. fragments the packets into units allowed by the outbound interfaces MTU
   - D. none of these

3. 路由器通常采用 （　　） 连接以太网交换机。
   - A. RJ-45端口
   - B. Console端口
   - C. 异步串口
   - D. 高速同步串口

4. 以下关于三层交换机的叙述中，正确的是 （　　）。
   - A. 三层交换机包括二层交换和三层转发，二层交换由硬件实现，三层转发采用软件实现
   - B. 三层交换机仅实现三层转发功能
   - C. 通常路由器用在单位内部，三层交换机放置在出口
   - D. 三层交换机除了存储转发外，还可以采用直通交换技术

# 二、简答题

5. 请画出图10‑1 (a) 所有路由器设备的路由表，其 IP 配置如图 (b) 所示。标明：目的地、网络掩码、下一跳。

(a) 网络架构图（设备与 IP 对照）

| Device     | IP                                 |
|------------|------------------------------------|
| Router 1   | 10.0.0.1                           |
| Router 2   | 10.0.0.4, 20.0.0.1, 30.0.0.1       |
| Router 3   | 20.0.0.2, 40.0.0.1                 |
| Router 4   | 30.0.0.3                           |
| Router 5   | 40.0.0.5                           |
| Server 1   | 10.0.0.2                           |
| Server 2   | 10.0.0.3                           |
| Server 3   | 20.0.0.3                           |
| Server 4   | 20.0.0.5                           |
| Server 5   | 40.0.0.2                           |
| Server 6   | 40.0.0.3                           |
| Laptop 1   | 40.0.0.4                           |
| Computer 1 | 20.0.0.4                           |
| Printer 1  | 30.0.0.2                           |
| Net 1      | 10.0.0.0/8                         |
| Net 2      | 20.0.0.0/8                         |
| Net 3      | 30.0.0.0/8                         |
| Net 4      | 40.0.0.0/8                         |

(b) 设备与 IP 地址对照表见上表。

> 图10‑1 网络架构图（在考试/作业中画出拓扑并填写各路由器的路由表）。

6. 如图10‑2 (a) 所示，从 C1 向 C5 发送一个 IP 报文（报文总长 24 KB），其中 MTU 如图 (b) 所示。请写出此 IP 报文经 N1、N2、N3、N4、N5，在 R6 处每个分片的大小及其偏移量。（提示：IP 报头为 20 B。）

(a) 网络拓扑图

(b) 网络号、类型、MTU 对照关系

| Net | Type     | MTU    |
|-----|----------|--------|
| N1  | FDDI     | 4325 B |
| N2  | 802.11n  | 2346 B |
| N3  | Ethernet | 1500 B |
| N4  | TokenRing| 4464 B |
| N5  | 802.11n  | 2346 B |

> 图10‑2 网络结构示意图（在作答时请画出拓扑并标明 R6 处各分片信息）。

# 三、程序设计题

7. 用 C++ 语言实现一个函数：

```cpp
#include <vector>
using namespace std;

struct Fragment { 
    int length;    // fragment total length including IP header
    int offset;    // offset in bytes (or in 8-byte units as required)
};

// 参数：packetLength 为报文总长度（字节，含 20B IP 头），pathMTUs 为路径上各链路的 MTU 列表（字节）
vector<Fragment> fragmentPacket(int packetLength, const vector<int>& pathMTUs);
```

要求：
- 报文头固定为 20 字节；
- 请按路径上最小 MTU 对报文进行分片（每个数据片长度应考虑到 IP 报头 20B，并保证数据负载长度为 8 字节的整数倍以满足 IP 分片偏移量单位）；
- 输出每个分片的长度和偏移量；
- 编写简单的测试用例验证函数正确性。